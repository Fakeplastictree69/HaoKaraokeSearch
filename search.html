<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Karaoke Song Search</title>
<style>
body {
  font-family: sans-serif;
  padding: 20px;
}
input {
  width: 90%;
  font-size: 18px;
  padding: 10px;
}
.result {
  margin-top: 10px;
  padding: 8px;
  border-bottom: 1px solid #ccc;
}
a {
  text-decoration: none;
  color: #0066cc;
}
</style>
</head>

<body>

<h2>ğŸ¤ Karaoke æ­Œæ›²æœå°‹</h2>

<input id="q" placeholder="è¼¸å…¥æ­Œåï¼ˆæ—¥æ–‡ï¼ç¾…é¦¬æ‹¼éŸ³ï¼‰">

<div id="results"></div>

<script>
// ===== è¨­å®šè³‡æ–™ä¾†æºï¼ˆä½ çš„ Release é€£çµï¼‰=====
const DATA_URL = "https://github.com/Fakeplastictree69/HaoKaraokeSearch/releases/download/v1.0/data.json";

// ===== è®€å–è³‡æ–™ =====
let songs = [];

fetch(DATA_URL)
  .then(res => res.json())
  .then(data => {
    songs = data;
    console.log("è³‡æ–™è¼‰å…¥æˆåŠŸï¼Œå…±", songs.length, "ç­†");
  })
  .catch(err => {
    console.error("è®€å–è³‡æ–™å¤±æ•—ï¼š", err);
    document.getElementById("results").innerHTML =
      "<b>âŒ ç„¡æ³•è¼‰å…¥è³‡æ–™ï¼Œè«‹ç¢ºèª data.json æ˜¯å¦å­˜åœ¨</b>";
  });

// ===== å·¥å…·å‡½å¼ =====
function normalize(str) {
  return str
    .toLowerCase()
    .replace(/[ã‚¡-ãƒ³]/g, c => String.fromCharCode(c.charCodeAt(0) - 0x60))
    .replace(/[\s\-_.]/g, "");
}

// ===== æœå°‹äº‹ä»¶ =====
document.getElementById("q").addEventListener("input", () => {
  const keyword = normalize(document.getElementById("q").value);
  const box = document.getElementById("results");
  box.innerHTML = "";

  if (!keyword) return;

  let found = 0;

  for (const song of songs) {
    const title = song.title || "";
    const norm = normalize(title);

    if (norm.includes(keyword)) {
      const div = document.createElement("div");
      div.className = "result";
      div.innerHTML = `
        <b>${title}</b><br>
        <a href="https://youtu.be/${song.id}" target="_blank">é–‹å•Ÿå½±ç‰‡</a>
      `;
      box.appendChild(div);
      found++;
    }
  }

  if (found === 0) {
    box.innerHTML = "<i>æ‰¾ä¸åˆ°ç¬¦åˆçš„æ­Œæ›²</i>";
  }
});
</script>

</body>
</html>
